# Pulsar Functions
## Pulsar Functions是什么？
    Pulsar Functions是一个运行在Pulsar之上的无服务器计算框架
Pulsar Functions是一个运行在Pulsar之上的无服务器计算框架，并以以下方式处理消息：
- 使用来自一个或多个主题的消息
- 对消息应用用户定义的处理逻辑
- 将消息的输出发布到其他主题

下图说明了函数计算过程中的三个步骤：
![img_43.png](img_43.png)
每次函数接收到消息时，它都会完成以下消费-应用-发布步骤:
1. 使用来自一个或多个输入主题的消息
2. 将定制的(用户提供的)处理逻辑应用到消息
3. 发布消息的输出，包括
   1. 将输出消息写入Pulsar中的输出主题
   2. 将日志写入日志主题(如果已配置)以进行调试
   3. 将状态更新写入BookKeeper(如果已配置)
      
我们可以用Java、Python和Go编写函数。例如，您可以使用Pulsar Functions来设置以下处理链.
1. Python函数监听原始语句主题并“消毒”传入字符串(删除多余的空白并将所有字符转换为小写)，然后将结果发布到已消毒的语句主题
2. Java函数监听经过处理的句子主题，计算每个单词在指定时间窗口内出现的次数，并将结果发布到结果主题
3. Python函数监听结果主题并将结果写入MySQL表

## 为什么使用Pulsar Functions？
    Pulsar函数在将消息路由到消费者之前对消息执行简单的计算。这些lambda风格的功能是专门设计的，并与Pulsar集成在一起。
    该框架在Pulsar集群上提供了一个简单的计算框架，并负责发送和接收消息的底层细节。我们只需要关注业务逻辑。
Pulsar函数使我们的组织能够最大限度地发挥数据的价值，并享受数据的好处：
1. 简化部署和操作——无需部署单独的流处理引擎(SPE)，如Apache Storm、Apache Heron或Apache Flink，即可创建数据管道
2. 无服务器计算(当您使用Kubernetes运行时)
3. 最大化开发人员的生产力
4. 故障排除简单

## 实例
1. 该图显示了实现经典单词计数用例的过程：
![img_44.png](img_44.png)
2. 该图演示了实现基于内容的路由用例的过程：
![img_45.png](img_45.png)
# 完全限定函数名
    每个函数都有一个完全限定函数名(FQFN)，具有指定的租户、命名空间和函数名。使用FQFN，我们可以在不同的名称空间中使用相同的函数名创建多个函数。
```text
tenant/namespace/name
```
## 函数实例
函数实例是函数执行框架的核心元素，由以下元素组成：
1. 消费来自不同输入主题的消息的消费者的集合
2. 调用函数的执行程序
3. 将函数的结果发送到输出主题的生产者
![img_46.png](img_46.png)
一个函数可以有多个实例，每个实例执行一个函数的副本。可以在配置文件中指定实例数

函数实例中的使用者使用FQFN作为订阅者名，以基于订阅类型在多个实例之间实现负载平衡。订阅类型可以在函数级别指定

每个函数都有一个单独的FQFN状态存储。我们可以指定一个状态接口，以便在BookKeeper中持久化中间结果。其他用户可以查询函数的状态并提取这些结果
