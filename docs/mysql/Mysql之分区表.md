# Mysql之分区表
    对于用户来讲，分区表是一个独立的逻辑表，但是底层由多个物理子表组成。实现分区的代码实际上是对一组底层表的句柄对象的封装。对分区表的请求，
    都会通过句柄对象转化成对存储引擎的接口调用。每一个分区表都有一个使用#分隔命名的表文件。
    mysql实现分区表的方式--对底层表的封装--意味着索引也是按照分区的子表定义的，而没有全局索引

mysql在创建表时，使用`PARTITION BY`子句定义每个分区存放的数据。在执行查询时，优化器会根据分区定义过滤那些没有我们需要数据的分区。

分区的主要目的是将数据按照一个较粗的粒度分在不同的表中。这样可以将相关的数据存放在一起，一次批量删除整个分区的数据也是比较方便的。

# 分区表的适用场景
    - 表非常大以至于无法全部都放在内存中，或者只在表的最后部分有热点数据，其他均是历史数据
    - 分区表的数据更容易维护。还可以对一个独立的分区进行优化/检查/修复等操作
    - 分区表的数据可以分布在不同的物理设备上，从而高效的利用多个硬件设备
    - 可以使用分区表类避免某些特殊的瓶颈，如单个索引的互斥访问，ext3文件系统的inode锁竞争等
    - 可以备份和恢复独立的分区

# 分区表的限制
    - 一个表最多只能有1024个分区
    - 在mysql 5.1中，分区表达式必须是整数，或者返回整数的表达式。mysql 5.5中，某些场景中可以直接使用列来进行分区
    - 如果分区字段中有主键或者唯一索引的列，那么所有主键列和唯一索引列都必须包含进来
    - 分区表中无法使用外键约束

# 分区表的原理
    底层由多个物理子表组成，这些底层表也是由句柄对象表示，所以我们可以直接访问各个分区。存储引擎管理分区的各个底层表和管理普通表一样，分区表
    的索引只是在各个底层表上各自加上一个完全相同的索引。
分区表的操作逻辑如下：
    
    - select 查询
        当查询一个分区表的时候，分区层先打开并锁住所有的底层表，优化器先判断是否可以过滤部分分区，然后再调用对应的存储引擎接口访问各个分区的数据
    - insert 操作
        当新增一条记录的时候，分区层先打开并锁住所有的底层表，然后确定哪个分区接受这条数据，然后将数据写入对应的底层表中
    - delete操作
        当删除一条记录的时候，分区层先打开并锁住所有的底层表，然后确定数据对应的分区，最后对相应底层表进行删除操作
    - update操作
        当修改一条记录的时候，分区层先打开并锁住所有的底层表，mysql先确认需要更新的数据在哪一个分区，然后取出数据并更新。在判断更新后的数据应该
        放在哪一个分区，最后对底层表进行写入操作，并对原数据所在的底层表进行删除操作。

这里的舵主所有的底层表并不是说分区表在处理过程中是锁全表的，如果存储引擎能够自己实现行级锁，就会在分区层释放对应的表锁

# 分区表的类型
    - 根据范围进行分区
    - 键值分区
    - 哈希分区
    - 列表分区
    - range columns类型分区（mysql 5.5）

